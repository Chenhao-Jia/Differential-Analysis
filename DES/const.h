

using namespace std;
typedef unsigned int ElemType;

ElemType s1[4][16] = { { 0xe,0x4,0xd,0x1,0x2,0xf,0xb,0x8,0x3,0xa,0x6,0xc,0x5,0x9,0x0,0x7 },
{ 0x0,0xf,0x7,0x4,0xe,0x2,0xd,0x1,0xa,0x6,0xc,0xb,0x9,0x5,0x3,0x8 },
{ 0x4,0x1,0xe,0x8,0xd,0x6,0x2,0xb,0xf,0xc,0x9,0x7,0x3,0xa,0x5,0x0 },
{ 0xf,0xc,0x8,0x2,0x4,0x9,0x1,0x7,0x5,0xb,0x3,0xe,0xa,0x0,0x6,0xd } }; //s盒

ElemType s2[4][16] = { { 0xf,0x1,0x8,0xe,0x6,0xb,0x3,0x4,0x9,0x7,0x2,0xd,0xc,0x0,0x5,0xa },
{ 0x3,0xd,0x4,0x7,0xf,0x2,0x8,0xe,0xc,0x0,0x1,0xa,0x6,0x9,0xb,0x5 },
{ 0x0,0xe,0x7,0xb,0xa,0x4,0xd,0x1,0x5,0x8,0xc,0x6,0x9,0x3,0x2,0xf },
{ 0xd,0x8,0xa,0x1,0x3,0xf,0x4,0x2,0xb,0x6,0x7,0xc,0x0,0x5,0xe,0x9 } };

ElemType s3[4][16] = { { 0xa,0x0,0x9,0xe,0x6,0x3,0xf,0x5,0x1,0xd,0xc,0x7,0xb,0x4,0x2,0x8 },
{ 0xd,0x7,0x0,0x9,0x3,0x4,0x6,0xa,0x2,0x8,0x5,0xe,0xc,0xb,0xf,0x1 },
{ 0xd,0x6,0x4,0x9,0x8,0xf,0x3,0x0,0xb,0x1,0x2,0xc,0x5,0xa,0xe,0x7 },
{ 0x1,0xa,0xd,0x0,0x6,0x9,0x8,0x7,0x4,0xf,0xe,0x3,0xb,0x5,0x2,0xc } };

ElemType s4[4][16] = { { 0x7,0xd,0xe,0x3,0x0,0x6,0x9,0xa,0x1,0x2,0x8,0x5,0xb,0xc,0x4,0xf },
{ 0xd,0x8,0xb,0x5,0x6,0xf,0x0,0x3,0x4,0x7,0x2,0xc,0x1,0xa,0xe,0x9 },
{ 0xa,0x6,0x9,0x0,0xc,0xb,0x7,0xd,0xf,0x1,0x3,0xe,0x5,0x2,0x8,0x4 },
{ 0x3,0xf,0x0,0x6,0xa,0x1,0xd,0x8,0x9,0x4,0x5,0xb,0xc,0x7,0x2,0xe } };

ElemType s5[4][16] = { { 0x2,0xc,0x4,0x1,0x7,0xa,0xb,0x6,0x8,0x5,0x3,0xf,0xd,0x0,0xe,0x9 },
{ 0xe,0xb,0x2,0xc,0x4,0x7,0xd,0x1,0x5,0x0,0xf,0xa,0x3,0x9,0x8,0x6 },
{ 0x4,0x2,0x1,0xb,0xa,0xd,0x7,0x8,0xf,0x9,0xc,0x5,0x6,0x3,0x0,0xe },
{ 0xb,0x8,0xc,0x7,0x1,0xe,0x2,0xd,0x6,0xf,0x0,0x9,0xa,0x4,0x5,0x3 } };

ElemType s6[4][16] = { { 0xc,0x1,0xa,0xf,0x9,0x2,0x6,0x8,0x0,0xd,0x3,0x4,0xe,0x7,0x5,0xb },
{ 0xa,0xf,0x4,0x2,0x7,0xc,0x9,0x5,0x6,0x1,0xd,0xe,0x0,0xb,0x3,0x8 },
{ 0x9,0xe,0xf,0x5,0x2,0x8,0xc,0x3,0x7,0x0,0x4,0xa,0x1,0xd,0xb,0x6 },
{ 0x4,0x3,0x2,0xc,0x9,0x5,0xf,0xa,0xb,0xe,0x1,0x7,0x6,0x0,0x8,0xd } };

ElemType s7[4][16] = { { 0x4,0xb,0x2,0xe,0xf,0x0,0x8,0xd,0x3,0xc,0x9,0x7,0x5,0xa,0x6,0x1 },
{ 0xd,0x0,0xb,0x7,0x4,0x9,0x1,0xa,0xe,0x3,0x5,0xc,0x2,0xf,0x8,0x6 },
{ 0x1,0x4,0xb,0xd,0xc,0x3,0x7,0xe,0xa,0xf,0x6,0x8,0x0,0x5,0x9,0x2 },
{ 0x6,0xb,0xd,0x8,0x1,0x4,0xa,0x7,0x9,0x5,0x0,0xf,0xe,0x2,0x3,0xc } };

ElemType s8[4][16] = { { 0xd,0x2,0x8,0x4,0x6,0xf,0xb,0x1,0xa,0x9,0x3,0xe,0x5,0x0,0xc,0x7 },
{ 0x1,0xf,0xd,0x8,0xa,0x3,0x7,0x4,0xc,0x5,0x6,0xb,0x0,0xe,0x9,0x2 },
{ 0x7,0xb,0x4,0x1,0x9,0xc,0xe,0x2,0x0,0x6,0xa,0xd,0xf,0x3,0x5,0x8 },
{ 0x2,0x1,0xe,0x7,0x4,0xa,0x8,0xd,0xf,0xc,0x9,0x0,0x3,0x5,0x6,0xb } }; 

//
u32 Tr1[16] = {
	0x00000000, 0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006, 0x00000007,
	0x00000008, 0x00000009, 0x0000000a, 0x0000000b, 0x0000000c, 0x0000000d, 0x0000000e, 0x0000000f
};

//置换表
u32 p1[16] = {
	0x00000000, 0x00000002, 0x00000200, 0x00000202, 0x00008000, 0x00008002, 0x00008200, 0x00008202,
	0x00800000, 0x00800002, 0x00800200, 0x00800202, 0x00808000, 0x00808002, 0x00808200, 0x00808202
};
u32 p2[16] = {
	0x00000000, 0x00004000, 0x40000000, 0x40004000, 0x00000010, 0x00004010, 0x40000010, 0x40004010,
	0x00080000, 0x00084000, 0x40080000, 0x40084000, 0x00080010, 0x00084010, 0x40080010, 0x40084010
};
u32 p3[16] = {
	0x00000000, 0x04000000, 0x00000004, 0x04000004, 0x00010000, 0x04010000, 0x00010004, 0x04010004,
	0x00000100, 0x04000100, 0x00000104, 0x04000104, 0x00010100, 0x04010100, 0x00010104, 0x04010104
};
u32 p4[16] = {
	0x00000000, 0x80000000, 0x00400000, 0x80400000, 0x00001000, 0x80001000, 0x00401000, 0x80401000,
	0x00000040, 0x80000040, 0x00400040, 0x80400040, 0x00001040, 0x80001040, 0x00401040, 0x80401040,
};
u32 p5[16] = {
	0x00000000, 0x20000000, 0x00000080, 0x20000080, 0x00040000, 0x20040000, 0x00040080, 0x20040080,
	0x01000000, 0x21000000, 0x01000080, 0x21000080, 0x01040000, 0x21040000, 0x01040080, 0x21040080
};
u32 p6[16] = {
	0x00000000, 0x00002000, 0x00200000, 0x00202000, 0x00000008, 0x00002008, 0x00200008, 0x00202008,
	0x10000000, 0x10002000, 0x10200000, 0x10202000, 0x10000008, 0x10002008, 0x10200008, 0x10202008
};
u32 p7[16] = {
	0x00000000, 0x02000000, 0x00000400, 0x02000400, 0x00100000, 0x02100000, 0x00100400, 0x02100400,
	0x00000001, 0x02000001, 0x00000401, 0x02000401, 0x00100001, 0x02100001, 0x00100401, 0x02100401
};
u32 p8[16] = {
	0x00000000, 0x00000800, 0x00200000, 0x00200800, 0x00000020, 0x00000820, 0x00200020, 0x00200820,
	0x08000000, 0x08000800, 0x08200000, 0x08200800, 0x08000020, 0x08000820, 0x08200020, 0x08200820
};

//扩展变换表 32→64
u64 ext[8][16] = {
{
	0x0000000000000000, 0x00000a0000000000, 0x0000100000000000, 0x00001a0000000000,
	0x0000200000000000, 0x00002a0000000000, 0x0000300000000000, 0x00003a0000000000,
	0x0000400000000001, 0x00004a0000000001, 0x0000500000000001, 0x00005a0010000001,
	0x0000600000000001, 0x00006a0000000001, 0x0000700000000001, 0x00007a0000000001,
},
{
	0x0000000000000000, 0x0000002800000000, 0x0000004000000000, 0x0000006800000000,
	0x0000008000000000, 0x000000a800000000, 0x000000c000000000, 0x000000e800000000,
	0x0000050000000000, 0x0000052800000000, 0x0000054000000000, 0x0000056800000000,
	0x0000058000000000, 0x000005a800000000, 0x000005c000000000, 0x000005e800000000,

},
{
	0x0000000000000000, 0x00000000a0000000, 0x0000000100000000, 0x00000001a0000000,
	0x0000000200000000, 0x00000002a0000000, 0x0000000300000000, 0x00000003a0000000,
	0x0000001400000000, 0x00000014a0000000, 0x0000001500000000, 0x00000015a0000000,
	0x0000001600000000, 0x00000016a0000000, 0x0000001700000000, 0x00000017a0000000,
},
{
	0x0000000000000000, 0x0000000002800000, 0x0000000004000000, 0x0000000006800000,
	0x0000000008000000, 0x000000000a800000, 0x000000000c000000, 0x000000000e800000,
	0x0000000050000000, 0x0000000052800000, 0x0000000054000000, 0x0000000056800000,
	0x0000000058000000, 0x000000005a800000, 0x000000005c000000, 0x000000005e800000,
},
{
	0x0000000000000000, 0x00000000000a0000, 0x0000000000100000, 0x00000000001a0000,
	0x0000000000200000, 0x00000000002a0000, 0x0000000000300000, 0x00000000003a0000,
	0x0000000001400000, 0x00000000014a0000, 0x0000000001500000, 0x00000000015a0000,
	0x0000000001600000, 0x00000000016a0000, 0x0000000001700000, 0x00000000017a0000
},
{
	0x0000000000000000, 0x0000000000002800, 0x0000000000004000, 0x0000000000006800,
	0x0000000000008000, 0x000000000000a800, 0x000000000000c000, 0x000000000000e800,
	0x0000000000050000, 0x0000000000052800, 0x0000000000054000, 0x0000000000056800,
	0x0000000000058000, 0x000000000005a800, 0x000000000005c000, 0x000000000005e800,
},
{
	0x0000000000000000, 0x00000000000000a0, 0x0000000000000100, 0x00000000000001a0,
	0x0000000000000200, 0x00000000000002a0, 0x0000000000000300, 0x00000000000003a0,
	0x0000000000001400, 0x00000000000014a0, 0x0000000000001500, 0x00000000000015a0,
	0x0000000000001600, 0x00000000000016a0, 0x0000000000001700, 0x00000000000017a0
},
{
	0x0000000000000000, 0x0000800000000002, 0x0000000000000004, 0x0000800000000006,
	0x0000000000000008, 0x000080000000000a, 0x000000000000000c, 0x000080000000000e,
	0x0000000000000050, 0x0000800000000052, 0x0000000000000054, 0x0000800000000056,
	0x0000000000000058, 0x000080000000005a, 0x000000000000005c, 0x000080000000005e,
}
};

//扩展逆变换， s盒输入→32
u32 MExt[8][4] = { 
	{0x00000000, 0x20000000, 0x40000000, 0x60000000},{0x00000000, 0x02000000, 0x04000000, 0x06000000},
	{0x00000000, 0x00200000, 0x00400000, 0x00600000},{0x00000000, 0x00020000, 0x00040000, 0x00060000},
	{0x00000000, 0x00002000, 0x00004000, 0x00006000},{0x00000000, 0x00000200, 0x00000400, 0x00000600},
	{0x00000000, 0x00000020, 0x00000040, 0x00000060},{0x00000000, 0x00000002, 0x00000004, 0x00000006}
};
u32 FExt[8][4] = {
	{0x00000000, 0x80000000, 0x00000001, 0x80000001},{0x00000000, 0x08000000, 0x10000000, 0x18000000},
	{0x00000000, 0x00800000, 0x01000000, 0x01800000},{0x00000000, 0x00080000, 0x00100000, 0x00180000},
	{0x00000000, 0x00008000, 0x00010000, 0x00018000},{0x00000000, 0x00000800, 0x00001000, 0x00001800},
	{0x00000000, 0x00000080, 0x00000100, 0x00000180},{0x00000000, 0x00000008, 0x00000010, 0x00000018}
};
